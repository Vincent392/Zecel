#IRQs and PICs
Welcome! i'll explain in this document what are irqs and pics!


#IRQs

Interrupt Requests or IRQs are interrupts raised by hardware devices.
Some devices generate an IRQ when they have data ready to be read, or when they finish a command like writing a buffer to the disk, for example. Its safe to say that a device will generate an IRQ when it wants the processor's attention. IRQs are generated by everything from network cards and sound cards to your mouse, keyboard and serial ports.

#PICs
Any IBM PC/AT Compatible computer (anything with a 286 and later processor) has 2 chips that are used to manage IRQs. These 2 chips are known as the Programmable Interrupt Controllers or PICs. These PICs also go by the name "8259". One 8259 acts as the "Master" IRQ controller, and one is the "Slave" IRQ controller. The slave is connected to IRQ2 on the master controller. The master IRQ controller is directly connected to the processor itself, to send signals. Each PIC Can Handle 8 IRQs. The master PIC handles IRQs 0 to 7, and the slave PIC handles IRQs 8 to 15.

Remember that the slave controller is connected to the primary controller through IRQ2: This means that every time an IRQ from 8 to 15 occurs, IRQ2 fires at exactly the same time.


When a device signals an IRQ, remember that an interrupt is generated, and the CPU pauses whatever its doing to call the ISR to handle the corresponding IRQ. The CPU then performs whatever necessary action (like reading from the keyboard, for example), and then it must tell the PIC that the interrupt that came from the CPU has finished executing the correct routine. The CPU tells the PIC that the interrupt is complete by writing command byte 0x20 in hex to the command register for that PIC.

The master PIC's command register exists at I/O port 0x20, while the slave PIC's command register exists at I/O port 0xA0. 

We need to also know that IRQ0 to IRQ7 are originally mapped to IDT entries 8 through 15. IRQ8 to IRQ15 are mapped to IDT entries 0x70 through 0x78. 

IDT entries 0 through 31 are reserved for exceptions. Fortunately, the Interrupt Controllers are 'programmable': You can change what IDT entries that their IRQs are mapped to.

For us, we will map IRQ0 through IRQ15 to IDT entries 32 through 47.

For an idea of my implementation on this, check arch/x86/interrupts folder, theres for now irq.c and irq.h there.